{% extends 'vote/base.html' %}
{% load static %}
{% block content %}


id: {{user.username}}
<br>
nickname: {{user.nickname}}
<br>
MBTI: {{user.mbti}}
<br>
성별: {{user.gender}}
<br>
{% if request.user == user %}
    <a href="{% url 'vote:update' %}">회원 수정</a>
    <a href="{% url 'account:change_password' %}">비밀번호 변경</a> 
    <a href="{% url 'account:delete' %}">회원 탈퇴</a>
{% endif %}

<h5>나의 vote list</h5>
{% for page in page_obj %}
    <span>{{page.title}}</span>
{% endfor %}

<div class="pagination-box">
    <div class="pagination">
      {% if page_obj.has_previous %}
      <a class="page-btn gray" href="?page={{ page_obj.previous_page_number }}">
        <img src="{% static 'img/icon/left_page.png' %}" style="width: 30px" />
      </a>
      {% endif %} {% for page_number in page_obj.paginator.page_range %}
      <a
        class="page-btn {% if page_number == page_obj.number %}red-pink{% endif %}"
        href="?page={{ page_number }}"
      >
        {{ page_number }}
      </a>
      {% endfor %} {% if page_obj.has_next %}
      <a class="page-btn gray" href="?page={{ page_obj.next_page_number }}">
        <img src="{% static 'img/icon/right_page.png' %}" style="width: 30px" />
      </a>
      {% endif %}
    </div>
  </div>
  {% endblock %}
</div>


<script>
    document.addEventListener("DOMContentLoaded", function () {
      const pollList = document.querySelector(".main-grid-content");
      const pagination = document.querySelector(".pagination");
  
      pagination.addEventListener("click", function (event) {
        if (event.target.tagName === "A") {
          event.preventDefault();
          const pageUrl = event.target.getAttribute("href");
  
          fetch(pageUrl)
            .then((response) => response.text())
            .then((data) => {
              const parser = new DOMParser();
              const newDoc = parser.parseFromString(data, "text/html");
  
              pollList.innerHTML =
                newDoc.querySelector(".main-grid-content").innerHTML;
              pagination.innerHTML =
                newDoc.querySelector(".pagination").innerHTML;
            })
            .catch((error) => console.error("Error fetching page:", error));
        }
      });
    });
  
    selectSort.addEventListener("change", function () {
    const sortValue = selectSort.value;
    const pageUrl = `{% url 'vote:main' %}?sort=${sortValue}`;
    updateContent(pageUrl);
  });
  
  </script>
