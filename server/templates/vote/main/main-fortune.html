{% extends 'vote/base.html' %}
{% load static %}

{% block content %}
<div class="fortune-container">
    <p class="fortune-title">ğŸ¥  ì˜¤ëŠ˜ì˜ í¬ì¶˜ ì¿ í‚¤ ğŸ¥ </p>
    <img src="{% static 'img/Cookie.png' %}" style="width: 350px"/>
    <button id="fortune-modal-open">í¬ì¶˜ ì¿ í‚¤ ì—´ì–´ë³´ê¸°</button>
    <div class="fortune-modal">
        <div id="capture" class="fortune-modal-content">
          <span class="modal-close-icon" id="fortune-modal-close">&times;</span>
          <div class="fortune-img-wrap">
            <img class="modal-logo" src="{% static 'img/Only_Text.png' %}" alt="logo">
            <img class="fortune-open-img" src="{% static 'img/slide/BrokenCookie.png' %}" alt="fortune-cookie-open">
            <p class="fortune-text">
              <span id="fortune-result">
                {% if user.is_authenticated %}
                    {{ user.mbti }}ì¸ ë‹¹ì‹ ì€{{ random_fortune }}
                {% else %}
                    {{ random_fortune }}
                {% endif %}
              </span>
          </p>
          </div>
          <button id="capBtn" style="border: none">ìº¡ì²˜í•˜ê¸°</button> 
          <button id="fortune-retry">ë‹¤ì‹œë½‘ê¸°</button>
        </div>
    </div>
</div>
<script>
  const modal = document.querySelector(".fortune-modal");
  const modalOpen = document.querySelector("#fortune-modal-open");
  const modalRetry = document.querySelector("#fortune-retry");
  const fortuneResult = document.querySelector("#fortune-result");
  
  modalOpen.addEventListener("click", () => {
    modal.style.display = "block";
  });

  const modalClose = document.querySelector("#fortune-modal-close");
  modalClose.addEventListener("click", () => {
    modal.style.display = "none";
  });

  modalRetry.addEventListener("click", () => {
    fortuneResult.textContent = "í¬ì¶˜ ì¿ í‚¤ ë‹¤ì‹œ ë½‘ëŠ” ì¤‘...";
    setTimeout(() => {
      location.reload();
    }, 2000); // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
  });
</script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="../../static/js/html2canvas.js"></script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
{% endblock %}
